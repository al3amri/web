<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¹Ø§Ø±Ø¶ JSON Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ - Ù…Ø¹ Ø¯Ø¹Ù… HTTP/2 Ùˆ CloudFront</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .main-box {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }
        
        .input-section {
            margin-bottom: 30px;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            direction: ltr;
            resize: vertical;
            margin-bottom: 15px;
            transition: border-color 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
            min-width: 150px;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        .btn-danger:hover {
            background: #d32f2f;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #4CAF50;
            color: white;
        }
        
        .btn-success:hover {
            background: #388E3C;
            transform: translateY(-2px);
        }
        
        .btn-paste {
            background: #ff9800;
            color: white;
        }
        
        .btn-paste:hover {
            background: #f57c00;
            transform: translateY(-2px);
        }
        
        .btn-http {
            background: #2196F3;
            color: white;
        }
        
        .btn-http:hover {
            background: #1976D2;
            transform: translateY(-2px);
        }
        
        .error-message {
            color: #f44336;
            background: #ffebee;
            padding: 10px;
            border-radius: 10px;
            margin-top: 10px;
            text-align: center;
            font-weight: bold;
        }
        
        .stats {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 15px;
            margin: 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .stats span {
            background: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: #333;
        }
        
        /* Ù‚Ø³Ù… Ø§Ù„Ø±Ø¤ÙˆØ³ HTTP */
        .headers-section {
            background: #1e1e2f;
            color: #fff;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
            direction: ltr;
        }
        
        .headers-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ff9800;
        }
        
        .http-badge {
            background: #4CAF50;
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 12px;
        }
        
        .cloudfront-badge {
            background: #ff9800;
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 12px;
        }
        
        .headers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 10px;
        }
        
        .header-item {
            background: rgba(255,255,255,0.1);
            padding: 8px 12px;
            border-radius: 8px;
            border-left: 3px solid #ff9800;
        }
        
        .header-key {
            color: #ff9800;
            font-weight: bold;
            margin-bottom: 3px;
            font-size: 12px;
        }
        
        .header-value {
            color: #fff;
            font-size: 11px;
            word-break: break-all;
        }
        
        .http-status {
            display: inline-block;
            background: #4CAF50;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-right: 10px;
        }
        
        /* Ù‚Ø³Ù…ÙŠÙ† Ø¬Ù†Ø¨ Ø¨Ø¹Ø¶ */
        .split-view {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        
        .images-section {
            flex: 2;
        }
        
        .info-section {
            flex: 1;
            min-width: 300px;
        }
        
        .images-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .image-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border: 1px solid #e0e0e0;
            position: relative;
        }
        
        .image-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        
        .image-preview {
            width: 100%;
            height: 150px;
            object-fit: cover;
            background: #f5f5f5;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .image-preview:hover {
            transform: scale(1.05);
        }
        
        .image-info {
            padding: 10px;
        }
        
        .image-url {
            font-size: 10px;
            color: #666;
            word-break: break-all;
            background: #f5f5f5;
            padding: 5px;
            border-radius: 5px;
            margin: 5px 0;
            direction: ltr;
            font-family: monospace;
        }
        
        .copy-btn {
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 11px;
            border: none;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
        }
        
        .copy-btn:hover {
            background: #5a67d8;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            cursor: pointer;
            justify-content: center;
            align-items: center;
        }
        
        .modal img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 10px;
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
            background: rgba(0,0,0,0.5);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        
        .modal-close:hover {
            background: rgba(0,0,0,0.8);
        }
        
        .image-order {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
        }
        
        .private-badge {
            position: absolute;
            top: 5px;
            left: 5px;
            background: #ff9800;
            color: white;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 10px;
            font-weight: bold;
            z-index: 10;
        }
        
        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 16px;
            margin: 15px 0;
            padding-right: 40px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%23666" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
        }
        
        /* ÙƒØ±ÙˆØª Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª */
        .info-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
        }
        
        .info-card h3 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .location-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-right: 4px solid #667eea;
        }
        
        .coordinates {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        
        .coord-box {
            flex: 1;
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        
        .coord-box .label {
            font-size: 12px;
            color: #666;
            display: block;
            margin-bottom: 5px;
        }
        
        .coord-box .value {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            font-family: monospace;
        }
        
        .map-link {
            display: inline-block;
            background: #4CAF50;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 14px;
            margin-top: 10px;
            transition: background 0.3s;
        }
        
        .map-link:hover {
            background: #388E3C;
        }
        
        /* ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø© */
        .footer {
            text-align: center;
            margin-top: 30px;
            color: white;
            font-size: 14px;
        }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #f0f0f0;
            border-radius: 5px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s;
            border-radius: 5px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .split-view {
                flex-direction: column;
            }
        }
        
        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .quick-btn {
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }
        
        .quick-btn:hover {
            background: #667eea;
            color: white;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù€ Headers Input */
        .headers-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            direction: ltr;
            resize: vertical;
            margin-bottom: 10px;
            background: #1e1e2f;
            color: #fff;
        }
        
        .tab-buttons {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .tab-btn {
            background: #e0e0e0;
            border: none;
            padding: 8px 15px;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 14px;
        }
        
        .tab-btn.active {
            background: #1e1e2f;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ Ø¹Ø§Ø±Ø¶ JSON Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ - HTTP/2 & CloudFront</h1>
        
        <div class="main-box">
            <div class="input-section">
                <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ -->
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchTab('json')">ğŸ“¦ JSON</button>
                    <button class="tab-btn" onclick="switchTab('headers')">ğŸ“‹ HTTP Headers</button>
                    <button class="tab-btn" onclick="switchTab('both')">ğŸ”„ ÙƒÙ„ÙŠÙ‡Ù…Ø§</button>
                </div>
                
                <!-- Ø­Ù‚Ù„ JSON -->
                <div id="jsonTab">
                    <textarea id="jsonInput" placeholder="Ø§Ù„ØµÙ‚ JSON Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„Ù..."></textarea>
                </div>
                
                <!-- Ø­Ù‚Ù„ Headers -->
                <div id="headersTab" style="display: none;">
                    <textarea id="headersInput" class="headers-input" rows="10" placeholder="Ø§Ù„ØµÙ‚ Ø±Ø¤ÙˆØ³ HTTP Ù‡Ù†Ø§..."></textarea>
                </div>
                
                <!-- ÙƒÙ„Ø§ Ø§Ù„Ø­Ù‚Ù„ÙŠÙ† -->
                <div id="bothTab" style="display: none;">
                    <textarea id="bothJsonInput" class="headers-input" rows="5" placeholder="Ø§Ù„ØµÙ‚ JSON Ù‡Ù†Ø§..."></textarea>
                    <textarea id="bothHeadersInput" class="headers-input" rows="5" placeholder="Ø§Ù„ØµÙ‚ Ø±Ø¤ÙˆØ³ HTTP Ù‡Ù†Ø§..."></textarea>
                </div>
                
                <div class="button-group">
                    <button class="btn-paste" onclick="pasteFromClipboard()">
                        ğŸ“‹ Ù„ØµÙ‚ Ù…Ù† Ø§Ù„Ø­Ø§ÙØ¸Ø©
                    </button>
                    <button class="btn-primary" onclick="parseAll()">
                        ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙ„
                    </button>
                    <button class="btn-http" onclick="parseHttpHeaders()">
                        ğŸŒ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø¤ÙˆØ³ ÙÙ‚Ø·
                    </button>
                    <button class="btn-danger" onclick="clearAll()">
                        ğŸ—‘ï¸ Ù…Ø³Ø­
                    </button>
                </div>
                
                <div class="quick-actions">
                    <button class="quick-btn" onclick="loadSampleData()">ğŸŒŸ ØªØ¬Ø±Ø¨Ø©</button>
                    <button class="quick-btn" onclick="copyAllUrls()">ğŸ“‹ Ù†Ø³Ø® ÙƒÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</button>
                    <button class="quick-btn" onclick="extractLocationsOnly()">ğŸ“ Ù†Ø³Ø® Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹</button>
                    <button class="quick-btn" onclick="downloadHeaders()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø¤ÙˆØ³</button>
                </div>
                
                <div id="error" class="error-message" style="display: none;"></div>
            </div>
            
            <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø¤ÙˆØ³ HTTP -->
            <div id="headersDisplay" style="display: none;">
                <div class="headers-section">
                    <div class="headers-title">
                        <span>ğŸ“‹ Ø±Ø¤ÙˆØ³ HTTP</span>
                        <span class="http-status" id="httpStatus">HTTP/2 200</span>
                        <span class="cloudfront-badge" id="cloudfrontStatus">ğŸŒ©ï¸ CloudFront</span>
                        <span class="http-badge" id="encodingBadge">ğŸ—œï¸ gzip</span>
                    </div>
                    <div class="headers-grid" id="headersGrid"></div>
                </div>
            </div>
            
            <div id="stats" class="stats" style="display: none;">
                <span id="imageCount">ğŸ“¸ ØµÙˆØ±: 0</span>
                <span id="privateCount">ğŸ”’ Ø®Ø§Øµ: 0</span>
                <span id="publicCount">ğŸ”“ Ø¹Ø§Ù…: 0</span>
                <span id="locationCount">ğŸ“ Ù…ÙˆØ§Ù‚Ø¹: 0</span>
                <span id="etagValue" style="background: #1e1e2f; color: #ff9800;">ğŸ†” ETAG</span>
            </div>
            
            <div class="progress-bar" id="progressBar" style="display: none;">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>
            
            <input type="text" id="searchInput" class="search-box" placeholder="ğŸ” Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ØµÙˆØ±..." style="display: none;">
            
            <div class="split-view">
                <div class="images-section">
                    <h3 style="margin-bottom: 15px; color: #333;">ğŸ“¸ Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</h3>
                    <div id="imagesContainer" class="images-container"></div>
                </div>
                
                <div class="info-section">
                    <div class="info-card">
                        <h3>ğŸ“ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>
                        <div id="locationsContainer">
                            <p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù„Ø¹Ø±Ø¶Ù‡Ø§</p>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <h3>ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª CloudFront</h3>
                        <div id="cloudfrontInfo">
                            <p style="color: #666; text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <h3>âš¡ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <button onclick="sortByOrder()" class="quick-btn">ğŸ”„ ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø±Ù‚Ù…</button>
                            <button onclick="showOnlyPrivate()" class="quick-btn">ğŸ”’ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø®Ø§Øµ ÙÙ‚Ø·</button>
                            <button onclick="showOnlyPublic()" class="quick-btn">ğŸ”“ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ø§Ù… ÙÙ‚Ø·</button>
                            <button onclick="generateHtmlGallery()" class="quick-btn">ğŸ“„ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ø¶ HTML</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="loading" class="loading" style="display: none;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
        
        <div class="footer">
            <p>Â© 2024 - Ø¹Ø§Ø±Ø¶ JSON Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ | ÙŠØ¯Ø¹Ù… HTTP/2 Ùˆ CloudFront | ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</p>
        </div>
    </div>
    
    <!-- Modal Ù„Ù„ØªÙƒØ¨ÙŠØ± -->
    <div id="imageModal" class="modal" onclick="closeModal()">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <img id="modalImage" src="" alt="ØµÙˆØ±Ø© Ù…ÙƒØ¨Ø±Ø©">
    </div>

    <script>
        let currentImages = [];
        let currentLocations = [];
        let currentHeaders = {};
        let originalData = null;
        let activeTab = 'json';
        
        // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function switchTab(tab) {
            activeTab = tab;
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('jsonTab').style.display = tab === 'json' || tab === 'both' ? 'block' : 'none';
            document.getElementById('headersTab').style.display = tab === 'headers' ? 'block' : 'none';
            document.getElementById('bothTab').style.display = tab === 'both' ? 'block' : 'none';
        }
        
        // Ø¯Ø§Ù„Ø© Ø§Ù„Ù„ØµÙ‚ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
        async function pasteFromClipboard() {
            try {
                const text = await navigator.clipboard.readText();
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                if (text.includes('HTTP/2') || text.includes('CloudFront') || text.includes('server:')) {
                    // Ù‡Ø°Ø§ ÙŠØ¨Ø¯Ùˆ ÙƒØ±Ø¤ÙˆØ³ HTTP
                    document.getElementById('headersInput').value = text;
                    switchTab('headers');
                    parseHttpHeaders(text);
                } else {
                    // Ù‡Ø°Ø§ ÙŠØ¨Ø¯Ùˆ ÙƒÙ€ JSON
                    document.getElementById('jsonInput').value = text;
                    switchTab('json');
                    parseJSON(text);
                }
            } catch (err) {
                alert('âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø§ÙØ¸Ø©. Ø§Ù„ØµÙ‚ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø£Ùˆ Ø§Ø³Ù…Ø­ Ø¨Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©.');
            }
        }
        
        // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø¤ÙˆØ³ HTTP
        function parseHttpHeaders(headersText) {
            const text = headersText || document.getElementById('headersInput').value;
            const headers = {};
            const lines = text.split('\n');
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø­Ø§Ù„Ø© HTTP
            const statusLine = lines.find(l => l.includes('HTTP/'));
            if (statusLine) {
                headers['_status'] = statusLine;
                document.getElementById('httpStatus').textContent = statusLine;
            }
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø±Ø¤ÙˆØ³
            lines.forEach(line => {
                const match = line.match(/^([^:]+):\s*(.+)$/);
                if (match) {
                    const key = match[1].trim();
                    const value = match[2].trim();
                    headers[key] = value;
                }
            });
            
            currentHeaders = headers;
            displayHeaders(headers);
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø§Øª
            if (headers['server'] && headers['server'].includes('CloudFront')) {
                document.getElementById('cloudfrontStatus').style.display = 'inline-block';
            }
            if (headers['content-encoding'] === 'gzip') {
                document.getElementById('encodingBadge').style.display = 'inline-block';
            }
            
            // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª CloudFront
            displayCloudFrontInfo(headers);
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø¤ÙˆØ³
        function displayHeaders(headers) {
            const grid = document.getElementById('headersGrid');
            let html = '';
            
            Object.entries(headers).forEach(([key, value]) => {
                if (key !== '_status') {
                    html += `
                        <div class="header-item">
                            <div class="header-key">${key}</div>
                            <div class="header-value">${value}</div>
                        </div>
                    `;
                }
            });
            
            grid.innerHTML = html;
            document.getElementById('headersDisplay').style.display = 'block';
            
            // ØªØ­Ø¯ÙŠØ« ETAG ÙÙŠ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            if (headers['etag']) {
                document.getElementById('etagValue').innerHTML = `ğŸ†” ${headers['etag'].substring(0, 20)}...`;
            }
        }
        
        // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª CloudFront
        function displayCloudFrontInfo(headers) {
            const container = document.getElementById('cloudfrontInfo');
            
            const info = {
                'ğŸŒ Edge Location': headers['x-amz-cf-pop'] || 'ØºÙŠØ± Ù…ØªÙˆÙØ±',
                'ğŸ†” Request ID': headers['x-amz-cf-id'] || 'ØºÙŠØ± Ù…ØªÙˆÙØ±',
                'ğŸ’¾ Cache Status': headers['x-cache'] || 'ØºÙŠØ± Ù…ØªÙˆÙØ±',
                'ğŸ–¥ï¸ Server': headers['server'] || 'ØºÙŠØ± Ù…ØªÙˆÙØ±',
                'ğŸ“¦ Via': headers['via'] || 'ØºÙŠØ± Ù…ØªÙˆÙØ±',
                'ğŸ—œï¸ Encoding': headers['content-encoding'] || 'ØºÙŠØ± Ù…ØªÙˆÙØ±',
                'ğŸ“ Type': headers['content-type'] || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'
            };
            
            let html = '<div style="display: grid; gap: 10px;">';
            
            Object.entries(info).forEach(([key, value]) => {
                html += `
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 8px;">
                        <strong style="color: #ff9800;">${key}:</strong>
                        <span style="float: left; font-family: monospace;">${value}</span>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        // ØªØ­Ù„ÙŠÙ„ JSON
        function parseJSON(jsonText) {
            const jsonInput = jsonText || document.getElementById('jsonInput').value;
            const errorDiv = document.getElementById('error');
            const imagesContainer = document.getElementById('imagesContainer');
            const loading = document.getElementById('loading');
            const stats = document.getElementById('stats');
            const searchBox = document.getElementById('searchInput');
            const progressBar = document.getElementById('progressBar');
            
            errorDiv.style.display = 'none';
            loading.style.display = 'block';
            imagesContainer.innerHTML = '';
            progressBar.style.display = 'block';
            document.getElementById('progressFill').style.width = '30%';
            
            try {
                const data = JSON.parse(jsonInput);
                originalData = data;
                
                document.getElementById('progressFill').style.width = '60%';
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ù…ÙˆØ§Ù‚Ø¹
                const images = extractImageUrls(data);
                const locations = extractLocations(data);
                
                currentImages = images;
                currentLocations = locations;
                
                document.getElementById('progressFill').style.width = '100%';
                
                if (images.length === 0 && locations.length === 0) {
                    errorDiv.innerHTML = 'âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØµÙˆØ± Ø£Ùˆ Ù…ÙˆØ§Ù‚Ø¹ ÙÙŠ Ø§Ù„Ù€ JSON';
                    errorDiv.style.display = 'block';
                    stats.style.display = 'none';
                    searchBox.style.display = 'none';
                } else {
                    displayImages(images);
                    displayLocations(locations);
                    updateStats(images, locations);
                    
                    stats.style.display = 'flex';
                    searchBox.style.display = 'block';
                    searchBox.value = '';
                }
            } catch (e) {
                errorDiv.innerHTML = 'âŒ Ø®Ø·Ø£: JSON ØºÙŠØ± ØµØ§Ù„Ø­ - ' + e.message;
                errorDiv.style.display = 'block';
                stats.style.display = 'none';
                searchBox.style.display = 'none';
                imagesContainer.innerHTML = '';
                document.getElementById('locationsContainer').innerHTML = '<p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù„Ø¹Ø±Ø¶Ù‡Ø§</p>';
            } finally {
                loading.style.display = 'none';
                setTimeout(() => {
                    progressBar.style.display = 'none';
                }, 500);
            }
        }
        
        // ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙ„ Ù…Ø¹Ø§Ù‹
        function parseAll() {
            if (activeTab === 'json') {
                parseJSON();
            } else if (activeTab === 'headers') {
                parseHttpHeaders();
            } else if (activeTab === 'both') {
                const jsonText = document.getElementById('bothJsonInput').value;
                const headersText = document.getElementById('bothHeadersInput').value;
                
                if (jsonText) parseJSON(jsonText);
                if (headersText) parseHttpHeaders(headersText);
            }
        }
        
        // Ø¯ÙˆØ§Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚)
        function extractImageUrls(obj, images = []) {
            if (obj && typeof obj === 'object') {
                if (obj.url && typeof obj.url === 'string' && isImageUrl(obj.url)) {
                    images.push({
                        url: obj.url,
                        order: obj.order || images.length + 1,
                        isPrivate: obj.isPrivate || false,
                        id: obj.id || `img_${Date.now()}_${Math.random()}`
                    });
                }
                
                for (let key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        if (key === 'url' && typeof obj[key] === 'string' && isImageUrl(obj[key])) {
                            images.push({
                                url: obj[key],
                                order: obj.order || images.length + 1,
                                isPrivate: obj.isPrivate || false,
                                id: obj.id || `img_${Date.now()}_${Math.random()}`
                            });
                        } else if (typeof obj[key] === 'object') {
                            extractImageUrls(obj[key], images);
                        }
                    }
                }
            } else if (Array.isArray(obj)) {
                obj.forEach(item => extractImageUrls(item, images));
            }
            
            return images.filter((img, index, self) => 
                index === self.findIndex((i) => i.url === img.url)
            );
        }
        
        function extractLocations(obj, locations = []) {
            if (obj && typeof obj === 'object') {
                if (obj.location && (obj.location.longitude || obj.location.lon || obj.location.lng) && (obj.location.latitude || obj.location.lat)) {
                    locations.push({
                        longitude: obj.location.longitude || obj.location.lon || obj.location.lng,
                        latitude: obj.location.latitude || obj.location.lat,
                        name: obj.name || obj.title || 'Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø³Ù…Ù‰',
                        description: obj.description || ''
                    });
                }
                
                for (let key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        if (key === 'location' && obj[key] && typeof obj[key] === 'object') {
                            if ((obj[key].longitude || obj[key].lon || obj[key].lng) && (obj[key].latitude || obj[key].lat)) {
                                locations.push({
                                    longitude: obj[key].longitude || obj[key].lon || obj[key].lng,
                                    latitude: obj[key].latitude || obj[key].lat,
                                    name: obj.name || obj.title || 'Ù…ÙˆÙ‚Ø¹',
                                    description: obj.description || ''
                                });
                            }
                        } else if (key === 'longitude' || key === 'lon' || key === 'lng') {
                            const lon = obj[key];
                            const lat = obj.latitude || obj.lat;
                            if (lat) {
                                locations.push({
                                    longitude: lon,
                                    latitude: lat,
                                    name: obj.name || obj.title || 'Ù…ÙˆÙ‚Ø¹',
                                    description: obj.description || ''
                                });
                            }
                        } else if (typeof obj[key] === 'object') {
                            extractLocations(obj[key], locations);
                        }
                    }
                }
            } else if (Array.isArray(obj)) {
                obj.forEach(item => extractLocations(item, locations));
            }
            
            return locations.filter((loc, index, self) => 
                index === self.findIndex((l) => l.longitude === loc.longitude && l.latitude === loc.latitude)
            );
        }
        
        function isImageUrl(url) {
            return url.includes('.jpg') || url.includes('.jpeg') || url.includes('.png') || 
                   url.includes('.gif') || url.includes('.webp') || url.includes('.bmp');
        }
        
        function displayImages(images) {
            const container = document.getElementById('imagesContainer');
            container.innerHTML = '';
            
            images.sort((a, b) => (a.order || 0) - (b.order || 0));
            
            images.forEach((img, index) => {
                const card = document.createElement('div');
                card.className = 'image-card fade-in';
                card.dataset.url = img.url.toLowerCase();
                
                const order = img.order || index + 1;
                
                card.innerHTML = `
                    ${order ? `<div class="image-order">#${order}</div>` : ''}
                    ${img.isPrivate ? '<div class="private-badge">ğŸ”’ Ø®Ø§Øµ</div>' : ''}
                    <img class="image-preview" src="${img.url}" alt="ØµÙˆØ±Ø© ${order}" onclick="openModal('${img.url}')" loading="lazy" onerror="this.src='https://via.placeholder.com/200x150?text=Ø®Ø·Ø£+ÙÙŠ+Ø§Ù„ØªØ­Ù…ÙŠÙ„'">
                    <div class="image-info">
                        <div class="image-url">${img.url.substring(0, 50)}...</div>
                        <button class="copy-btn" onclick="copyToClipboard('${img.url}', this)">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        function displayLocations(locations) {
            const container = document.getElementById('locationsContainer');
            
            if (locations.length === 0) {
                container.innerHTML = '<p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù„Ø¹Ø±Ø¶Ù‡Ø§</p>';
                return;
            }
            
            let html = '';
            locations.forEach((loc, index) => {
                const googleMapsLink = `https://www.google.com/maps?q=${loc.latitude},${loc.longitude}`;
                
                html += `
                    <div class="location-item">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <strong>ğŸ“ Ù…ÙˆÙ‚Ø¹ ${index + 1}</strong>
                            <span style="background: #667eea; color: white; padding: 3px 8px; border-radius: 12px; font-size: 11px;">${loc.name || 'ØºÙŠØ± Ù…Ø³Ù…Ù‰'}</span>
                        </div>
                        <div class="coordinates">
                            <div class="coord-box">
                                <span class="label">Ø®Ø· Ø§Ù„Ø·ÙˆÙ„ (Longitude)</span>
                                <span class="value">${loc.longitude}</span>
                            </div>
                            <div class="coord-box">
                                <span class="label">Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶ (Latitude)</span>
                                <span class="value">${loc.latitude}</span>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <a href="${googleMapsLink}" target="_blank" class="map-link">ğŸ—ºï¸ ÙØªØ­ ÙÙŠ Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„</a>
                            <button onclick="copyCoordinates(${loc.latitude}, ${loc.longitude})" class="quick-btn" style="flex: 1;">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª</button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function updateStats(images, locations) {
            document.getElementById('imageCount').innerHTML = `ğŸ“¸ ØµÙˆØ±: ${images.length}`;
            document.getElementById('privateCount').innerHTML = `ğŸ”’ Ø®Ø§Øµ: ${images.filter(img => img.isPrivate).length}`;
            document.getElementById('publicCount').innerHTML = `ğŸ”“ Ø¹Ø§Ù…: ${images.filter(img => !img.isPrivate).length}`;
            document.getElementById('locationCount').innerHTML = `ğŸ“ Ù…ÙˆØ§Ù‚Ø¹: ${locations.length}`;
        }
        
        function filterImages() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filtered = currentImages.filter(img => img.url.toLowerCase().includes(searchTerm));
            displayImages(filtered);
        }
        
        function clearAll() {
            document.getElementById('jsonInput').value = '';
            document.getElementById('headersInput').value = '';
            document.getElementById('bothJsonInput').value = '';
            document.getElementById('bothHeadersInput').value = '';
            document.getElementById('imagesContainer').innerHTML = '';
            document.getElementById('locationsContainer').innerHTML = '<p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù„Ø¹Ø±Ø¶Ù‡Ø§</p>';
            document.getElementById('error').style.display = 'none';
            document.getElementById('stats').style.display = 'none';
            document.getElementById('searchInput').style.display = 'none';
            document.getElementById('headersDisplay').style.display = 'none';
            document.getElementById('searchInput').value = '';
            currentImages = [];
            currentLocations = [];
            currentHeaders = {};
            originalData = null;
        }
        
        function copyToClipboard(text, btn) {
            navigator.clipboard.writeText(text).then(() => {
                const originalText = btn.innerHTML;
                btn.innerHTML = 'âœ… ØªÙ…!';
                btn.style.background = '#4CAF50';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '#667eea';
                }, 2000);
            });
        }
        
        function copyCoordinates(lat, lon) {
            navigator.clipboard.writeText(`${lat}, ${lon}`).then(() => {
                alert('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª');
            });
        }
        
        function openModal(url) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            modal.style.display = 'flex';
            modalImg.src = url;
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
        }
        
        function loadSampleData() {
            const sampleJson = `{
  "result": {
    "user": {
      "id": "90iHH90u5t",
      "location": {
        "longitude": 50.01581087063288,
        "latitude": 26.558439325819666
      },
      "userImages": [
        {
          "id": "s9boyzkOjq",
          "imageFile": {
            "url": "https://d3haz8kz57vxxi.cloudfront.net/f4bd56e0352d0552f9245295098b6c0e_image.jpg"
          },
          "order": 2,
          "isPrivate": false
        },
        {
          "id": "B4VxAdMkBF",
          "imageFile": {
            "url": "https://d3haz8kz57vxxi.cloudfront.net/87d2db8f04dda77c1dd0c6a422bca2f6_image.jpg"
          },
          "order": 3,
          "isPrivate": false
        }
      ]
    }
  }
}`;

            const sampleHeaders = `HTTP/2 200
server: CloudFront
content-type: application/json; charset=utf-8
date: Sat, 14 Feb 2026 13:33:45 GMT
access-control-expose-headers: X-Parse-Job-Status-Id, X-Parse-Push-Status-Id
vary: accept-encoding
access-control-allow-origin: *
access-control-allow-methods: GET,PUT,POST,DELETE,OPTIONS
content-encoding: gzip
etag: W/"78a-4m7Qzdad2n2f/selbUgUfb8fIks"
x-cache: Miss from cloudfront
via: 1.1 a5b35da3a37f3b4542ea89737243a522.cloudfront.net (CloudFront)
x-amz-cf-pop: ZRH55-P2
x-amz-cf-id: 9kDiBylX5Zs_zCHL8borNG2x5qAlmkuQOnHUOT_j_rFuo1aN2kF4YA==`;

            document.getElementById('jsonInput').value = sampleJson;
            document.getElementById('headersInput').value = sampleHeaders;
            document.getElementById('bothJsonInput').value = sampleJson;
            document.getElementById('bothHeadersInput').value = sampleHeaders;
            
            parseJSON(sampleJson);
            parseHttpHeaders(sampleHeaders);
        }
        
        function copyAllUrls() {
            if (currentImages.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±');
                return;
            }
            
            const urls = currentImages.map(img => img.url).join('\n');
            navigator.clipboard.writeText(urls).then(() => {
                alert(`âœ… ØªÙ… Ù†Ø³Ø® ${currentImages.length} Ø±Ø§Ø¨Ø·`);
            });
        }
        
        function extractLocationsOnly() {
            if (currentLocations.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹');
                return;
            }
            
            const locationsText = currentLocations.map(loc => 
                `${loc.name || 'Ù…ÙˆÙ‚Ø¹'}: ${loc.latitude}, ${loc.longitude}`
            ).join('\n');
            
            navigator.clipboard.writeText(locationsText).then(() => {
                alert(`âœ… ØªÙ… Ù†Ø³Ø® ${currentLocations.length} Ù…ÙˆÙ‚Ø¹`);
            });
        }
        
        function downloadHeaders() {
            if (Object.keys(currentHeaders).length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø¤ÙˆØ³ Ù„Ù„ØªØ­Ù…ÙŠÙ„');
                return;
            }
            
            let content = '';
            Object.entries(currentHeaders).forEach(([key, value]) => {
                content += `${key}: ${value}\n`;
            });
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `headers_${new Date().toISOString().slice(0,10)}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function sortByOrder() {
            if (currentImages.length === 0) return;
            currentImages.sort((a, b) => (a.order || 999) - (b.order || 999));
            displayImages(currentImages);
        }
        
        function showOnlyPrivate() {
            const privateImages = currentImages.filter(img => img.isPrivate);
            displayImages(privateImages);
        }
        
        function showOnlyPublic() {
            const publicImages = currentImages.filter(img => !img.isPrivate);
            displayImages(publicImages);
        }
        
        function generateHtmlGallery() {
            if (currentImages.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±');
                return;
            }
            
            let html = `
            <!DOCTYPE html>
            <html>
            <head>
                <title>Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± - Ù…Ø³ØªØ¶Ø§Ù Ø¹Ù„Ù‰ CloudFront</title>
                <style>
                    body { font-family: Arial; background: #f0f0f0; padding: 20px; }
                    .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px,1fr)); gap: 15px; }
                    img { width: 100%; height: 200px; object-fit: cover; border-radius: 8px; }
                    .header { background: #1e1e2f; color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1>ğŸ“¸ Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</h1>
                    <p>Ù…Ø³ØªØ¶Ø§Ù Ø¹Ù„Ù‰ CloudFront | Ø¹Ø¯Ø¯ Ø§Ù„ØµÙˆØ±: ${currentImages.length}</p>
                </div>
                <div class="gallery">
            `;
            
            currentImages.forEach(img => {
                html += `<img src="${img.url}" loading="lazy" onerror="this.src='https://via.placeholder.com/200x150?text=Ø®Ø·Ø£'">\n`;
            });
            
            html += `</div></body></html>`;
            
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `gallery_cloudfront_${new Date().toISOString().slice(0,10)}.html`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Ø¯Ø¹Ù… Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
        document.getElementById('jsonInput').addEventListener('dragover', (e) => {
            e.preventDefault();
            e.target.style.borderColor = '#667eea';
        });
        
        document.getElementById('jsonInput').addEventListener('dragleave', (e) => {
            e.target.style.borderColor = '#e0e0e0';
        });
        
        document.getElementById('jsonInput').addEventListener('drop', (e) => {
            e.preventDefault();
            e.target.style.borderColor = '#e0e0e0';
            
            const file = e.dataTransfer.files[0];
            if (file && file.type === 'application/json') {
                const reader = new FileReader();
                reader.onload = (event) => {
                    document.getElementById('jsonInput').value = event.target.result;
                    parseJSON();
                };
                reader.readAsText(file);
            } else {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø³Ù‚Ø§Ø· Ù…Ù„Ù JSON ØµØ­ÙŠØ­');
            }
        });
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
        window.onload = function() {
            loadSampleData();
        };
    </script>
</body>
</html>
