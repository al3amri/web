<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¹Ø§Ø±Ø¶ JSON Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ - ØµÙˆØ± ÙˆØ¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .main-box {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }
        
        .input-section {
            margin-bottom: 30px;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            direction: ltr;
            resize: vertical;
            margin-bottom: 15px;
            transition: border-color 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
            min-width: 150px;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        .btn-danger:hover {
            background: #d32f2f;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #4CAF50;
            color: white;
        }
        
        .btn-success:hover {
            background: #388E3C;
            transform: translateY(-2px);
        }
        
        .btn-paste {
            background: #ff9800;
            color: white;
        }
        
        .btn-paste:hover {
            background: #f57c00;
            transform: translateY(-2px);
        }
        
        .error-message {
            color: #f44336;
            background: #ffebee;
            padding: 10px;
            border-radius: 10px;
            margin-top: 10px;
            text-align: center;
            font-weight: bold;
        }
        
        .stats {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 15px;
            margin: 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .stats span {
            background: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: #333;
        }
        
        /* Ù‚Ø³Ù…ÙŠÙ† Ø¬Ù†Ø¨ Ø¨Ø¹Ø¶ */
        .split-view {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        
        .images-section {
            flex: 2;
        }
        
        .info-section {
            flex: 1;
            min-width: 300px;
        }
        
        .images-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .image-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border: 1px solid #e0e0e0;
            position: relative;
        }
        
        .image-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        
        .image-preview {
            width: 100%;
            height: 150px;
            object-fit: cover;
            background: #f5f5f5;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .image-preview:hover {
            transform: scale(1.05);
        }
        
        .image-info {
            padding: 10px;
        }
        
        .image-url {
            font-size: 10px;
            color: #666;
            word-break: break-all;
            background: #f5f5f5;
            padding: 5px;
            border-radius: 5px;
            margin: 5px 0;
            direction: ltr;
            font-family: monospace;
        }
        
        .copy-btn {
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 11px;
            border: none;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
        }
        
        .copy-btn:hover {
            background: #5a67d8;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            cursor: pointer;
            justify-content: center;
            align-items: center;
        }
        
        .modal img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 10px;
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
            background: rgba(0,0,0,0.5);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        
        .modal-close:hover {
            background: rgba(0,0,0,0.8);
        }
        
        .image-order {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
        }
        
        .private-badge {
            position: absolute;
            top: 5px;
            left: 5px;
            background: #ff9800;
            color: white;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 10px;
            font-weight: bold;
            z-index: 10;
        }
        
        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 16px;
            margin: 15px 0;
            padding-right: 40px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%23666" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
        }
        
        /* ÙƒØ±ÙˆØª Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª */
        .info-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
        }
        
        .info-card h3 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .location-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-right: 4px solid #667eea;
        }
        
        .coordinates {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        
        .coord-box {
            flex: 1;
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        
        .coord-box .label {
            font-size: 12px;
            color: #666;
            display: block;
            margin-bottom: 5px;
        }
        
        .coord-box .value {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            font-family: monospace;
        }
        
        .map-link {
            display: inline-block;
            background: #4CAF50;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 14px;
            margin-top: 10px;
            transition: background 0.3s;
        }
        
        .map-link:hover {
            background: #388E3C;
        }
        
        /* ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø© */
        .footer {
            text-align: center;
            margin-top: 30px;
            color: white;
            font-size: 14px;
        }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #f0f0f0;
            border-radius: 5px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s;
            border-radius: 5px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .split-view {
                flex-direction: column;
            }
        }
        
        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .quick-btn {
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }
        
        .quick-btn:hover {
            background: #667eea;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ Ø¹Ø§Ø±Ø¶ JSON Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ - ØµÙˆØ± ÙˆØ¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª</h1>
        
        <div class="main-box">
            <div class="input-section">
                <textarea id="jsonInput" placeholder="Ø§Ù„ØµÙ‚ JSON Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„Ù..."></textarea>
                
                <div class="button-group">
                    <button class="btn-paste" onclick="pasteJSON()">
                        ğŸ“‹ Ù„ØµÙ‚
                    </button>
                    <button class="btn-primary" onclick="parseJSON()">
                        ğŸ” Ø¹Ø±Ø¶
                    </button>
                    <button class="btn-danger" onclick="clearAll()">
                        ğŸ—‘ï¸ Ù…Ø³Ø­
                    </button>
                    <button class="btn-success" onclick="downloadAll()">
                        ğŸ“¥ ØªØ­Ù…ÙŠÙ„
                    </button>
                </div>
                
                <div class="quick-actions">
                    <button class="quick-btn" onclick="loadSampleData()">ğŸŒŸ ØªØ¬Ø±Ø¨Ø©</button>
                    <button class="quick-btn" onclick="copyAllUrls()">ğŸ“‹ Ù†Ø³Ø® ÙƒÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</button>
                    <button class="quick-btn" onclick="extractLocationsOnly()">ğŸ“ Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ ÙÙ‚Ø·</button>
                </div>
                
                <div id="error" class="error-message" style="display: none;"></div>
            </div>
            
            <div id="stats" class="stats" style="display: none;">
                <span id="imageCount">ğŸ“¸ ØµÙˆØ±: 0</span>
                <span id="privateCount">ğŸ”’ Ø®Ø§Øµ: 0</span>
                <span id="publicCount">ğŸ”“ Ø¹Ø§Ù…: 0</span>
                <span id="locationCount">ğŸ“ Ù…ÙˆØ§Ù‚Ø¹: 0</span>
            </div>
            
            <div class="progress-bar" id="progressBar" style="display: none;">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>
            
            <input type="text" id="searchInput" class="search-box" placeholder="ğŸ” Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ØµÙˆØ±..." style="display: none;">
            
            <div class="split-view">
                <div class="images-section">
                    <h3 style="margin-bottom: 15px; color: #333;">ğŸ“¸ Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</h3>
                    <div id="imagesContainer" class="images-container"></div>
                </div>
                
                <div class="info-section">
                    <div class="info-card">
                        <h3>ğŸ“ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>
                        <div id="locationsContainer">
                            <p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù„Ø¹Ø±Ø¶Ù‡Ø§</p>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <h3>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
                        <div id="advancedStats">
                            <p style="color: #666; text-align: center;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <h3>âš¡ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <button onclick="sortByOrder()" class="quick-btn">ğŸ”„ ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø±Ù‚Ù…</button>
                            <button onclick="showOnlyPrivate()" class="quick-btn">ğŸ”’ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø®Ø§Øµ ÙÙ‚Ø·</button>
                            <button onclick="showOnlyPublic()" class="quick-btn">ğŸ”“ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ø§Ù… ÙÙ‚Ø·</button>
                            <button onclick="generateHtmlGallery()" class="quick-btn">ğŸ“„ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ø¶ HTML</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="loading" class="loading" style="display: none;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
        
        <div class="footer">
            <p>Â© 2024 - Ø¹Ø§Ø±Ø¶ JSON Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ | ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</p>
        </div>
    </div>
    
    <!-- Modal Ù„Ù„ØªÙƒØ¨ÙŠØ± -->
    <div id="imageModal" class="modal" onclick="closeModal()">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <img id="modalImage" src="" alt="ØµÙˆØ±Ø© Ù…ÙƒØ¨Ø±Ø©">
    </div>

    <script>
        let currentImages = [];
        let currentLocations = [];
        let originalData = null;
        
        // Ø¯Ø§Ù„Ø© Ø§Ù„Ù„ØµÙ‚ Ù…Ù† Ø§Ù„Ø­Ø§ÙØ¸Ø©
        async function pasteJSON() {
            try {
                const text = await navigator.clipboard.readText();
                document.getElementById('jsonInput').value = text;
                parseJSON();
            } catch (err) {
                alert('âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø§ÙØ¸Ø©. Ø§Ù„ØµÙ‚ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø£Ùˆ Ø§Ø³Ù…Ø­ Ø¨Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©.');
            }
        }
        
        function parseJSON() {
            const jsonInput = document.getElementById('jsonInput').value;
            const errorDiv = document.getElementById('error');
            const imagesContainer = document.getElementById('imagesContainer');
            const loading = document.getElementById('loading');
            const stats = document.getElementById('stats');
            const searchBox = document.getElementById('searchInput');
            const progressBar = document.getElementById('progressBar');
            
            errorDiv.style.display = 'none';
            loading.style.display = 'block';
            imagesContainer.innerHTML = '';
            progressBar.style.display = 'block';
            document.getElementById('progressFill').style.width = '30%';
            
            try {
                const data = JSON.parse(jsonInput);
                originalData = data;
                
                document.getElementById('progressFill').style.width = '60%';
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ù…ÙˆØ§Ù‚Ø¹
                const images = extractImageUrls(data);
                const locations = extractLocations(data);
                
                currentImages = images;
                currentLocations = locations;
                
                document.getElementById('progressFill').style.width = '100%';
                
                if (images.length === 0 && locations.length === 0) {
                    errorDiv.innerHTML = 'âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØµÙˆØ± Ø£Ùˆ Ù…ÙˆØ§Ù‚Ø¹ ÙÙŠ Ø§Ù„Ù€ JSON';
                    errorDiv.style.display = 'block';
                    stats.style.display = 'none';
                    searchBox.style.display = 'none';
                } else {
                    displayImages(images);
                    displayLocations(locations);
                    updateStats(images, locations);
                    updateAdvancedStats(data);
                    
                    stats.style.display = 'flex';
                    searchBox.style.display = 'block';
                    searchBox.value = '';
                }
            } catch (e) {
                errorDiv.innerHTML = 'âŒ Ø®Ø·Ø£: JSON ØºÙŠØ± ØµØ§Ù„Ø­ - ' + e.message;
                errorDiv.style.display = 'block';
                stats.style.display = 'none';
                searchBox.style.display = 'none';
                imagesContainer.innerHTML = '';
                document.getElementById('locationsContainer').innerHTML = '<p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù„Ø¹Ø±Ø¶Ù‡Ø§</p>';
            } finally {
                loading.style.display = 'none';
                setTimeout(() => {
                    progressBar.style.display = 'none';
                }, 500);
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ØµÙˆØ±
        function extractImageUrls(obj, images = []) {
            if (obj && typeof obj === 'object') {
                if (obj.url && typeof obj.url === 'string' && isImageUrl(obj.url)) {
                    images.push({
                        url: obj.url,
                        order: obj.order || images.length + 1,
                        isPrivate: obj.isPrivate || false,
                        id: obj.id || `img_${Date.now()}_${Math.random()}`
                    });
                }
                
                for (let key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        if (key === 'url' && typeof obj[key] === 'string' && isImageUrl(obj[key])) {
                            images.push({
                                url: obj[key],
                                order: obj.order || images.length + 1,
                                isPrivate: obj.isPrivate || false,
                                id: obj.id || `img_${Date.now()}_${Math.random()}`
                            });
                        } else if (typeof obj[key] === 'object') {
                            extractImageUrls(obj[key], images);
                        }
                    }
                }
            } else if (Array.isArray(obj)) {
                obj.forEach(item => extractImageUrls(item, images));
            }
            
            return images.filter((img, index, self) => 
                index === self.findIndex((i) => i.url === img.url)
            );
        }
        
        // Ø¯Ø§Ù„Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
        function extractLocations(obj, locations = []) {
            if (obj && typeof obj === 'object') {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙƒØ§Ø¦Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ location
                if (obj.location && (obj.location.longitude || obj.location.lon || obj.location.lng) && (obj.location.latitude || obj.location.lat)) {
                    locations.push({
                        longitude: obj.location.longitude || obj.location.lon || obj.location.lng,
                        latitude: obj.location.latitude || obj.location.lat,
                        name: obj.name || obj.title || 'Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø³Ù…Ù‰',
                        description: obj.description || ''
                    });
                }
                
                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø®ØµØ§Ø¦Øµ
                for (let key in obj) {
                    if (obj.hasOwnProperty(key)) {
                        if (key === 'location' && obj[key] && typeof obj[key] === 'object') {
                            if ((obj[key].longitude || obj[key].lon || obj[key].lng) && (obj[key].latitude || obj[key].lat)) {
                                locations.push({
                                    longitude: obj[key].longitude || obj[key].lon || obj[key].lng,
                                    latitude: obj[key].latitude || obj[key].lat,
                                    name: obj.name || obj.title || 'Ù…ÙˆÙ‚Ø¹',
                                    description: obj.description || ''
                                });
                            }
                        } else if (key === 'longitude' || key === 'lon' || key === 'lng') {
                            // Ø¥Ø°Ø§ ÙˆØ¬Ø¯Ù†Ø§ longitudeØŒ Ù†Ø¨Ø­Ø« Ø¹Ù† latitude Ù‚Ø±ÙŠØ¨
                            const lon = obj[key];
                            const lat = obj.latitude || obj.lat;
                            if (lat) {
                                locations.push({
                                    longitude: lon,
                                    latitude: lat,
                                    name: obj.name || obj.title || 'Ù…ÙˆÙ‚Ø¹',
                                    description: obj.description || ''
                                });
                            }
                        } else if (typeof obj[key] === 'object') {
                            extractLocations(obj[key], locations);
                        }
                    }
                }
            } else if (Array.isArray(obj)) {
                obj.forEach(item => extractLocations(item, locations));
            }
            
            return locations.filter((loc, index, self) => 
                index === self.findIndex((l) => l.longitude === loc.longitude && l.latitude === loc.latitude)
            );
        }
        
        function isImageUrl(url) {
            return url.includes('.jpg') || url.includes('.jpeg') || url.includes('.png') || 
                   url.includes('.gif') || url.includes('.webp') || url.includes('.bmp');
        }
        
        function displayImages(images) {
            const container = document.getElementById('imagesContainer');
            container.innerHTML = '';
            
            images.sort((a, b) => (a.order || 0) - (b.order || 0));
            
            images.forEach((img, index) => {
                const card = document.createElement('div');
                card.className = 'image-card fade-in';
                card.dataset.url = img.url.toLowerCase();
                
                const order = img.order || index + 1;
                
                card.innerHTML = `
                    ${order ? `<div class="image-order">#${order}</div>` : ''}
                    ${img.isPrivate ? '<div class="private-badge">ğŸ”’ Ø®Ø§Øµ</div>' : ''}
                    <img class="image-preview" src="${img.url}" alt="ØµÙˆØ±Ø© ${order}" onclick="openModal('${img.url}')" loading="lazy" onerror="this.src='https://via.placeholder.com/200x150?text=Ø®Ø·Ø£+ÙÙŠ+Ø§Ù„ØªØ­Ù…ÙŠÙ„'">
                    <div class="image-info">
                        <div class="image-url">${img.url.substring(0, 50)}...</div>
                        <button class="copy-btn" onclick="copyToClipboard('${img.url}', this)">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        function displayLocations(locations) {
            const container = document.getElementById('locationsContainer');
            
            if (locations.length === 0) {
                container.innerHTML = '<p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù„Ø¹Ø±Ø¶Ù‡Ø§</p>';
                return;
            }
            
            let html = '';
            locations.forEach((loc, index) => {
                const googleMapsLink = `https://www.google.com/maps?q=${loc.latitude},${loc.longitude}`;
                
                html += `
                    <div class="location-item">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <strong>ğŸ“ Ù…ÙˆÙ‚Ø¹ ${index + 1}</strong>
                            <span style="background: #667eea; color: white; padding: 3px 8px; border-radius: 12px; font-size: 11px;">${loc.name || 'ØºÙŠØ± Ù…Ø³Ù…Ù‰'}</span>
                        </div>
                        <div class="coordinates">
                            <div class="coord-box">
                                <span class="label">Ø®Ø· Ø§Ù„Ø·ÙˆÙ„ (Longitude)</span>
                                <span class="value">${loc.longitude}</span>
                            </div>
                            <div class="coord-box">
                                <span class="label">Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶ (Latitude)</span>
                                <span class="value">${loc.latitude}</span>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <a href="${googleMapsLink}" target="_blank" class="map-link">ğŸ—ºï¸ ÙØªØ­ ÙÙŠ Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„</a>
                            <button onclick="copyCoordinates(${loc.latitude}, ${loc.longitude})" class="quick-btn" style="flex: 1;">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª</button>
                        </div>
                        ${loc.description ? `<p style="margin-top: 10px; color: #666;">ğŸ“ ${loc.description}</p>` : ''}
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function updateStats(images, locations) {
            document.getElementById('imageCount').innerHTML = `ğŸ“¸ ØµÙˆØ±: ${images.length}`;
            document.getElementById('privateCount').innerHTML = `ğŸ”’ Ø®Ø§Øµ: ${images.filter(img => img.isPrivate).length}`;
            document.getElementById('publicCount').innerHTML = `ğŸ”“ Ø¹Ø§Ù…: ${images.filter(img => !img.isPrivate).length}`;
            document.getElementById('locationCount').innerHTML = `ğŸ“ Ù…ÙˆØ§Ù‚Ø¹: ${locations.length}`;
        }
        
        function updateAdvancedStats(data) {
            const statsDiv = document.getElementById('advancedStats');
            
            // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©
            const totalKeys = countKeys(data);
            const depth = getDepth(data);
            const arrays = countArrays(data);
            
            statsDiv.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 12px; color: #666;">Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ù‚ÙˆÙ„</div>
                        <div style="font-size: 20px; font-weight: bold; color: #667eea;">${totalKeys}</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 12px; color: #666;">Ø¹Ù…Ù‚ JSON</div>
                        <div style="font-size: 20px; font-weight: bold; color: #764ba2;">${depth}</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 12px; color: #666;">Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµÙÙˆÙØ§Øª</div>
                        <div style="font-size: 20px; font-weight: bold; color: #4CAF50;">${arrays}</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 12px; color: #666;">Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                        <div style="font-size: 20px; font-weight: bold; color: #ff9800;">${Math.round(JSON.stringify(data).length / 1024)} KB</div>
                    </div>
                </div>
            `;
        }
        
        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function countKeys(obj) {
            if (typeof obj !== 'object' || obj === null) return 0;
            let count = 0;
            for (let key in obj) {
                if (obj.hasOwnProperty(key)) {
                    count++;
                    if (typeof obj[key] === 'object') {
                        count += countKeys(obj[key]);
                    }
                }
            }
            return count;
        }
        
        function getDepth(obj) {
            if (typeof obj !== 'object' || obj === null) return 0;
            let maxDepth = 0;
            for (let key in obj) {
                if (obj.hasOwnProperty(key)) {
                    maxDepth = Math.max(maxDepth, getDepth(obj[key]));
                }
            }
            return maxDepth + 1;
        }
        
        function countArrays(obj) {
            if (typeof obj !== 'object' || obj === null) return 0;
            let count = 0;
            if (Array.isArray(obj)) count++;
            for (let key in obj) {
                if (obj.hasOwnProperty(key)) {
                    count += countArrays(obj[key]);
                }
            }
            return count;
        }
        
        function filterImages() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filtered = currentImages.filter(img => img.url.toLowerCase().includes(searchTerm));
            displayImages(filtered);
        }
        
        function clearAll() {
            document.getElementById('jsonInput').value = '';
            document.getElementById('imagesContainer').innerHTML = '';
            document.getElementById('locationsContainer').innerHTML = '<p style="color: #666; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù„Ø¹Ø±Ø¶Ù‡Ø§</p>';
            document.getElementById('error').style.display = 'none';
            document.getElementById('stats').style.display = 'none';
            document.getElementById('searchInput').style.display = 'none';
            document.getElementById('searchInput').value = '';
            currentImages = [];
            currentLocations = [];
            originalData = null;
        }
        
        function copyToClipboard(text, btn) {
            navigator.clipboard.writeText(text).then(() => {
                const originalText = btn.innerHTML;
                btn.innerHTML = 'âœ… ØªÙ…!';
                btn.style.background = '#4CAF50';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '#667eea';
                }, 2000);
            });
        }
        
        function copyCoordinates(lat, lon) {
            navigator.clipboard.writeText(`${lat}, ${lon}`).then(() => {
                alert('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª');
            });
        }
        
        function openModal(url) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            modal.style.display = 'flex';
            modalImg.src = url;
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
        }
        
        function downloadAll() {
            if (currentImages.length === 0 && currentLocations.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØ­Ù…ÙŠÙ„');
                return;
            }
            
            let content = 'âš¡ ØªÙ‚Ø±ÙŠØ± JSON Ø§Ù„ÙƒØ§Ù…Ù„\n\n';
            content += `ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØµØ¯ÙŠØ±: ${new Date().toLocaleString('ar-SA')}\n`;
            content += `ğŸ“¸ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙˆØ±: ${currentImages.length}\n`;
            content += `ğŸ“ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹: ${currentLocations.length}\n`;
            content += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n`;
            
            if (currentImages.length > 0) {
                content += 'ğŸ“¸ Ø§Ù„ØµÙˆØ±:\n';
                currentImages.forEach((img, i) => {
                    content += `${i+1}. ${img.url}\n`;
                    content += `   Ø§Ù„ØªØ±ØªÙŠØ¨: ${img.order || i+1} | ${img.isPrivate ? 'ğŸ”’ Ø®Ø§Øµ' : 'ğŸ”“ Ø¹Ø§Ù…'}\n\n`;
                });
            }
            
            if (currentLocations.length > 0) {
                content += 'ğŸ“ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹:\n';
                currentLocations.forEach((loc, i) => {
                    content += `${i+1}. ${loc.name || 'Ù…ÙˆÙ‚Ø¹'}\n`;
                    content += `   Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª: ${loc.latitude}, ${loc.longitude}\n`;
                    content += `   Ø±Ø§Ø¨Ø· Ø®Ø±Ø§Ø¦Ø·: https://www.google.com/maps?q=${loc.latitude},${loc.longitude}\n\n`;
                });
            }
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ØªÙ‚Ø±ÙŠØ±_JSON_${new Date().toISOString().slice(0,10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function loadSampleData() {
            const sampleData = {
                "result": {
                    "user": {
                        "id": "kJxvFCbKPw",
                        "name": "Ashley AmirağŸ’–",
                        "location": {
                            "longitude": 50.01581087063288,
                            "latitude": 26.558439325819666
                        },
                        "userImages": [
                            {
                                "id": "ONdgh44JKY",
                                "imageFile": {
                                    "url": "https://d3haz8kz57vxxi.cloudfront.net/a02c4e98a453befaa3e97d0f305d1a92_image_9a85954b-bd1c-401b-9930-8f9e0018cb9f.jpg"
                                },
                                "order": 1,
                                "isPrivate": true
                            },
                            {
                                "id": "0OEfFD4Dde",
                                "imageFile": {
                                    "url": "https://d3haz8kz57vxxi.cloudfront.net/b48cf9a3e8af4163ee45d9758b21f6f3_image_cd1f4080-725f-49f9-8008-398820397df5.jpg"
                                },
                                "order": 2,
                                "isPrivate": true
                            },
                            {
                                "id": "6iIIFHGwaR",
                                "imageFile": {
                                    "url": "https://d3haz8kz57vxxi.cloudfront.net/38dc4fa736bdaff100b318d2cf4f68c7_image_24766dfd-ee47-432c-981b-45c880567451.jpg"
                                },
                                "order": 0,
                                "isPrivate": false
                            }
                        ]
                    }
                }
            };
            
            document.getElementById('jsonInput').value = JSON.stringify(sampleData, null, 2);
            parseJSON();
        }
        
        function copyAllUrls() {
            if (currentImages.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±');
                return;
            }
            
            const urls = currentImages.map(img => img.url).join('\n');
            navigator.clipboard.writeText(urls).then(() => {
                alert(`âœ… ØªÙ… Ù†Ø³Ø® ${currentImages.length} Ø±Ø§Ø¨Ø·`);
            });
        }
        
        function extractLocationsOnly() {
            if (currentLocations.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹');
                return;
            }
            
            const locationsText = currentLocations.map(loc => 
                `${loc.name || 'Ù…ÙˆÙ‚Ø¹'}: ${loc.latitude}, ${loc.longitude}`
            ).join('\n');
            
            navigator.clipboard.writeText(locationsText).then(() => {
                alert(`âœ… ØªÙ… Ù†Ø³Ø® ${currentLocations.length} Ù…ÙˆÙ‚Ø¹`);
            });
        }
        
        function sortByOrder() {
            if (currentImages.length === 0) return;
            currentImages.sort((a, b) => (a.order || 999) - (b.order || 999));
            displayImages(currentImages);
        }
        
        function showOnlyPrivate() {
            const privateImages = currentImages.filter(img => img.isPrivate);
            displayImages(privateImages);
        }
        
        function showOnlyPublic() {
            const publicImages = currentImages.filter(img => !img.isPrivate);
            displayImages(publicImages);
        }
        
        function generateHtmlGallery() {
            if (currentImages.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±');
                return;
            }
            
            let html = `
            <!DOCTYPE html>
            <html>
            <head>
                <title>Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</title>
                <style>
                    body { font-family: Arial; background: #f0f0f0; padding: 20px; }
                    .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px,1fr)); gap: 15px; }
                    img { width: 100%; height: 200px; object-fit: cover; border-radius: 8px; }
                </style>
            </head>
            <body>
                <h1>Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</h1>
                <div class="gallery">
            `;
            
            currentImages.forEach(img => {
                html += `<img src="${img.url}" loading="lazy">\n`;
            });
            
            html += `</div></body></html>`;
            
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `gallery_${new Date().toISOString().slice(0,10)}.html`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Ø¯Ø¹Ù… Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
        document.getElementById('jsonInput').addEventListener('dragover', (e) => {
            e.preventDefault();
            e.target.style.borderColor = '#667eea';
        });
        
        document.getElementById('jsonInput').addEventListener('dragleave', (e) => {
            e.target.style.borderColor = '#e0e0e0';
        });
        
        document.getElementById('jsonInput').addEventListener('drop', (e) => {
            e.preventDefault();
            e.target.style.borderColor = '#e0e0e0';
            
            const file = e.dataTransfer.files[0];
            if (file && file.type === 'application/json') {
                const reader = new FileReader();
                reader.onload = (event) => {
                    document.getElementById('jsonInput').value = event.target.result;
                    parseJSON();
                };
                reader.readAsText(file);
            } else {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø³Ù‚Ø§Ø· Ù…Ù„Ù JSON ØµØ­ÙŠØ­');
            }
        });
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
        window.onload = function() {
            loadSampleData();
        };
    </script>
</body>
</html>
